/*
 DUEL v0.8.6 http://duelengine.org
 Copyright (c)2006-2012 Stephen M. McKamey.
 Licensed under The MIT License.
*/
var duel=function(m,u,A){function x(a){this.value=a}function l(a){return"function"===typeof a}function k(a){switch(typeof a){case "object":return!a?0:y(a)?2:a instanceof x?5:a instanceof Date?4:3;case "function":return 1;case "undefined":return 0;default:return 4}}function p(){this.value=p.FAST?"":[]}function q(a){y(a)||(a=["",a]);this.value=a}function r(a,b){switch(k(b)){case 2:if(""===b[0])for(var c=1,f=b.length;c<f;c++)r(a,b[c]);else a.push(b);break;case 3:if(1===a.length)a.push(b);else if(c=a[1],
3===k(c))for(f in b)b.hasOwnProperty(f)&&(c[f]=b[f]);else a.splice(1,0,b);break;case 4:""!==b&&(b=""+b,c=a.length-1,0<c&&4===k(a[c])?a[c]+=b:a.push(b));break;case 0:break;default:a.push(b)}}function s(a,b,c,f,d,e){var g=3===k(a[1]);if(a.length===(g?3:2))return n(a[a.length-1],b,c,f,d,e);for(var h=[""],g=g?2:1,j=a.length;g<j;g++)r(h,n(a[g],b,c,f,d,e));return h}function B(a,b,c,f,d,e){for(var g=1,h=a.length;g<h;g++){var j=a[g],i=j[1].test;if(3===k(j[1])&&i&&(l(i)&&(i=i(b,c,f,d)),!i))continue;return s(j,
b,c,f,d,e)}return null}function K(a){return"string"!==typeof a?a:a.replace(/[&<>]/g,function(a){switch(a){case "&":return"&amp;";case "<":return"&lt;";case ">":return"&gt;";default:return a}})}function L(a){return"string"!==typeof a?a:a.replace(/[&<>"]/g,function(a){switch(a){case "&":return"&amp;";case "<":return"&lt;";case ">":return"&gt;";case '"':return"&quot;";default:return a}})}function C(a,b){var c=b[0]||"",f=b.length,d=1,e,g=M[c];if("!"===c.charAt(0))"!DOCTYPE"===b[0]?a.append("<!DOCTYPE ",
b[1],">"):a.append("<\!--",b[1],"--\>");else{if(c){a.append("<",c);e=b[d];if(3===k(e)){for(var h in e)if(e.hasOwnProperty(h)){var j=e[h];if(D[h.toLowerCase()])if(j)j=h;else continue;a.append(" ",h);0!==k(j)&&a.append('="',L(j),'"')}d++}g&&a.append(" /");a.append(">")}for(;d<f;d++)e=b[d],y(e)?C(a,e):a.append(K(e));c&&!g&&a.append("</",c,">")}}function t(a){if(a){if("!"===a.charAt(0))return m.createComment("!"===a?"":a.substr(1)+" ")}else{if(m.createDocumentFragment)return m.createDocumentFragment();
a=""}return"style"===a.toLowerCase()&&m.createStyleSheet?m.createStyleSheet():m.createElement(a)}function w(a,b){if(b){var c=(a.tagName||"").toLowerCase();if(8===a.nodeType)3===b.nodeType&&(a.nodeValue+=b.nodeValue);else if("table"===c&&a.tBodies)if(b.tagName)if((c=b.tagName.toLowerCase())&&"tbody"!==c&&"thead"!==c){var f=0<a.tBodies.length?a.tBodies[a.tBodies.length-1]:null;f||(f=t("th"===c?"thead":"tbody"),a.appendChild(f));f.appendChild(b)}else!1!==a.canHaveChildren&&a.appendChild(b);else{if(11===
b.nodeType)for(;b.firstChild;)w(a,b.removeChild(b.firstChild))}else if("style"===c&&m.createStyleSheet)a.cssText=b;else if(!1!==a.canHaveChildren)a.appendChild(b);else if("object"===c&&b.tagName&&"param"===b.tagName.toLowerCase()){try{a.appendChild(b)}catch(d){}try{a.object&&(a.object[b.name]=b.value)}catch(e){}}}}function E(a,b,c){"on"===b.substr(0,2)&&(b=b.substr(2));switch(typeof c){case "function":if(a.addEventListener)a.addEventListener(b,c,!1);else if(l(window.jQuery)&&0!==k(a[b]))if(a=window.jQuery(a),
l(a.on))a.on(b,c);else a.bind(b,c);else if(a.attachEvent&&0!==k(a[b]))a.attachEvent("on"+b,c);else{var f=a["on"+b]||a[b];a["on"+b]=a[b]=!l(f)?c:function(a){return!1!==f.call(this,a)&&!1!==c.call(this,a)}}break;case "string":a["on"+b]=new Function("event",c)}}function F(a){return!!a&&3===a.nodeType&&(!a.nodeValue||!/\S/.exec(a.nodeValue))}function G(a,b){a&&(3===a.nodeType&&b.exec(a.nodeValue))&&(a.nodeValue=a.nodeValue.replace(b,""))}function z(a){if(a){for(;F(a.firstChild);)a.removeChild(a.firstChild);
for(G(a.firstChild,N);F(a.lastChild);)a.removeChild(a.lastChild);G(a.lastChild,O)}}function H(a,b){var c=a[b];if(c){try{delete a[b]}catch(f){try{a[b]="",a.removeAttribute(b)}catch(d){}}if(!l(c))try{c=new Function(""+c)}catch(e){c=null}}return c}function I(a){if(a){var b=H(a,"$init");b&&b.call(a);(b=H(a,"$load"))?setTimeout(function(){b.call(a);b=a=null},0):b=a=null}}function J(a,b){for(var c=1,f=b.length;c<f;c++){var d=b[c];switch(k(d)){case 2:var e=d[0],d=J(t(e),d);if("html"===e)return z(d),I(d),
d;w(a,d);break;case 4:""!==d&&w(a,m.createTextNode(""+d));break;case 3:if(1===a.nodeType){var e=a,g=d;if(g.name&&m.attachEvent&&!e.parentNode)try{var h=t("<"+e.tagName+' name="'+g.name+'">');e.tagName===h.tagName&&(e=h)}catch(j){}d=void 0;for(d in g)if(g.hasOwnProperty(d)){var i=g[d],l=k(i);d&&(0===l&&(i="",l=4),d=P[d.toLowerCase()]||d,"style"===d?0!==k(e.style.cssText)?e.style.cssText=i:e.style=i:"on"===d.substr(0,2)?(E(e,d,i),(d=v[d])&&E(e,d,i)):!Q[d.toLowerCase()]&&(4!==l||"$"===d.charAt(0)||0!==
k(e[d])||0!==k(e[v[d]]))?(e[d]=i,(d=v[d])&&(e[d]=i)):D[d.toLowerCase()]?i&&(e.setAttribute(d,d),(d=v[d])&&e.setAttribute(d,d)):(e.setAttribute(d,i),(d=v[d])&&e.setAttribute(d,i)))}a=e}break;case 5:e=w;g=a;i=d;d=t("div");d.innerHTML=""+i;z(d);if(1===d.childNodes.length)d=d.firstChild;else{for(i=t("");d.firstChild;)i.appendChild(d.firstChild);d=i}e(g,d)}}z(a);I(a);11===a.nodeType&&1===a.childNodes.length&&(a=a.firstChild);return a}x.prototype.toString=function(){return this.value};var y=Array.isArray||
function(a){return a instanceof Array};p.FAST=!(u&&9>u());p.prototype.append=function(a,b,c){p.FAST?null!==a&&(this.value+=a,null!==b&&b!==A&&(this.value+=b,null!==c&&c!==A&&(this.value+=c))):this.value.push.apply(this.value,arguments)};p.prototype.clear=function(){this.value=p.FAST?"":[]};p.prototype.toString=function(){return p.FAST?this.value:this.value.join("")};var n;n=function(a,b,c,f,d,e){switch(k(a)){case 1:return a(b,c,f,d);case 2:var g=a[0]||"";switch(g){case "$for":a:{var h=a[1]||{},g=
[""],j;if(h.hasOwnProperty("count")){j=h.count;l(j)&&(j=j(b,c,f,d));h.hasOwnProperty("data")?(h=h.data,l(h)&&(h=h(b,c,f,d))):h=b;for(b=0;b<j;b++)r(g,s(a,h,b,j,null,e))}else{if(h.hasOwnProperty("in")){var i=h["in"];l(i)&&(i=i(b,c,f,d));if(3===k(i)){h=[];for(j in i)i.hasOwnProperty(j)&&h.push(j);b=0;for(j=h.length;b<j;b++)r(g,s(a,i[h[b]],b,j,h[b],e));a=g;break a}h=i}else h=h.each,l(h)&&(h=h(b,c,f,d));b=k(h);if(2===b){b=0;for(j=h.length;b<j;b++)r(g,s(a,h[b],b,j,null,e))}else 0!==b&&(g=s(a,h,0,1,null,
e))}a=g}return a;case "$xor":return B(a,b,c,f,d,e);case "$if":return B(["$xor",a],b,c,f,d,e);case "$call":e=a[1]||{};if(e.view){g=n(e.view,b,c,f,d);h=e.hasOwnProperty("data")?n(e.data,b,c,f,d):b;j=e.hasOwnProperty("index")?n(e.index,b,c,f,d):c;i=e.hasOwnProperty("count")?n(e.count,b,c,f,d):f;b=e.hasOwnProperty("key")?n(e.key,b,c,f,d):d;c={};for(f=a.length-1;2<=f;f--)d=a[f],e=d[1]||{},e.hasOwnProperty("name")&&(c[e.name]=d);a=g&&l(g.getView)?n(g.getView(),h,j,i,b,c):null}else a=null;return a;case "$part":return g=
(a[1]||{}).name||"",g=e&&e.hasOwnProperty(g)?e[g]:a,s(g,b,c,f,d)}g=[g];h=1;for(j=a.length;h<j;h++)r(g,n(a[h],b,c,f,d,e));return g;case 3:e={};for(g in a)a.hasOwnProperty(g)&&(e[g]=n(a[g],b,c,f,d));return e}return a};var D={async:1,autofocus:1,checked:1,defaultchecked:1,defer:1,disabled:1,formnovalidate:1,hidden:1,indeterminate:1,ismap:1,multiple:1,novalidate:1,readonly:1,required:1,spellcheck:1,willvalidate:1},u=function(a){if(!l(a)||!l(a.getView)){var b=a;2!==k(b)&&(b=["",b]);a=function(a,f,d,e){try{var g=
n(b,a,isFinite(f)?f:0,isFinite(d)?d:1,"string"===typeof e?e:null);return new q(g)}catch(h){return new q("["+h+"]")}};a.getView=function(){return b}}return a};u.raw=function(a){return new x(a)};var M={area:!0,base:!0,basefont:!0,br:!0,col:!0,frame:!0,hr:!0,img:!0,input:!0,isindex:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,wbr:!0};q.prototype.toString=function(){var a;var b=this.value;try{var c=new p;C(c,b);a=c.toString()}catch(f){a="["+f+"]"}return a};q.prototype.write=function(a){(a||m).write(""+
this)};var P={accesskey:"accessKey",bgcolor:"bgColor",cellpadding:"cellPadding",cellspacing:"cellSpacing",checked:"defaultChecked","class":"className",colspan:"colSpan",contenteditable:"contentEditable",defaultchecked:"defaultChecked","for":"htmlFor",formnovalidate:"formNoValidate",hidefocus:"hideFocus",ismap:"isMap",maxlength:"maxLength",novalidate:"noValidate",readonly:"readOnly",rowspan:"rowSpan",spellcheck:"spellCheck",tabindex:"tabIndex",usemap:"useMap",willvalidate:"willValidate"},v={enctype:"encoding",
onscroll:"DOMMouseScroll"},Q={autocapitalize:1,autocomplete:1,autocorrect:1},N=/^[\r\n]+/,O=/[\r\n]+$/;q.prototype.toDOM=function(a,b){4===k(a)&&(a=m.getElementById(a));var c;try{b&&(c=a,a=null),c=J(c||t(this.value[0]),this.value)}catch(f){c=m.createTextNode("["+f+"]")}a&&a.parentNode&&a.parentNode.replaceChild(c,a);return c};q.prototype.reload=function(){var a=m;try{var b=this.toDOM();a.replaceChild(b,a.documentElement);if(a.createStyleSheet){for(var c=b.firstChild;c&&"HEAD"!==(c.tagName||"");)c=
c.nextSibling;for(var f=c&&c.firstChild;f;){if("LINK"===(f.tagName||""))f.href=f.href;f=f.nextSibling}}}catch(d){a=a.open("text/html"),a.write(this.toString()),a.close()}};return u}(document,window.ScriptEngineMajorVersion);
