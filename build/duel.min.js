var duel=function(v){function w(a){this.value=a}function k(a){switch(typeof a){case "object":return!a?0:a instanceof Array?2:a instanceof w?5:a instanceof Date?4:3;case "function":return 1;case "undefined":return 0;default:return 4}}function m(a){return typeof a==="function"}function t(a){if(k(a)!==2)a=["",a];this.value=a}function p(a,b){switch(k(b)){case 2:if(b[0]==="")for(var d=1,g=b.length;d<g;d++)p(a,b[d]);else a.push(b);break;case 3:d=a[1];if(k(d)===3)for(g in b){if(b.hasOwnProperty(g))d[g]=
b[g]}else a.splice(1,0,b);break;case 4:d=a.length-1;if(d>0&&k(a[d])===4)a[d]=""+a[d]+b;else b!==""&&a.push(""+b);break;case 0:break;default:a.push(b)}}function q(a,b,d,g,c,e){var f=k(a[1])===3;if(a.length===(f?3:2))return l(a[a.length-1],b,d,g,c,e);var h=[""];f=f?2:1;for(var j=a.length;f<j;f++)p(h,l(a[f],b,d,g,c,e));return h}function A(a,b,d,g,c,e){for(var f=1,h=a.length;f<h;f++){var j=a[f],i=j[1].test;if(k(j[1])===3&&i){if(m(i))i=i(b,d,g,c);if(!i)continue}return q(j,b,d,g,c,e)}return null}function I(a){if(k(a)!==
2)a=["",a];var b=function(d){try{var g=l(a,d,0,1,null);return new t(g)}catch(c){return new t("["+c+"]")}};b.getView=function(){return a};return b}function o(){this.value=o.FAST?"":[]}function J(a){if(typeof a!=="string")return a;return a.replace(/[&<>]/g,function(b){switch(b){case "&":return"&amp;";case "<":return"&lt;";case ">":return"&gt;";default:return b}})}function K(a){if(typeof a!=="string")return a;return a.replace(/[&<>"]/g,function(b){switch(b){case "&":return"&amp;";case "<":return"&lt;";
case ">":return"&gt;";case '"':return"&quot;";default:return b}})}function B(a,b){var d=b[0]||"",g=b.length,c=1,e;if(d.charAt(0)==="!")b[0]==="!doctype"?a.append("<!doctype ",b[1],">"):a.append("<!--",b[1],"--\>");else{if(d){a.append("<",d);e=b[c];if(k(e)===3){for(var f in e)if(e.hasOwnProperty(f)){a.append(" ",f);var h=e[f];k(h)!==0&&a.append('="',K(h),'"')}c++}a.append(">")}for(;c<g;c++){e=b[c];k(e)===2?B(a,e):a.append(J(e))}d&&!L[d]&&a.append("</",d,">")}}function r(a){if(a){if(a.charAt(0)==="!")return n.createComment(a===
"!"?"":a.substr(1)+" ")}else{if(n.createDocumentFragment)return n.createDocumentFragment();a=""}if(a.toLowerCase()==="style"&&n.createStyleSheet)return n.createStyleSheet();return n.createElement(a)}function u(a,b){if(b){var d=(a.tagName||"").toLowerCase();if(a.nodeType===8){if(b.nodeType===3)a.nodeValue+=b.nodeValue}else if(d==="table"&&a.tBodies)if(b.tagName)if((d=b.tagName.toLowerCase())&&d!=="tbody"&&d!=="thead"){var g=a.tBodies.length>0?a.tBodies[a.tBodies.length-1]:null;if(!g){g=r(d==="th"?
"thead":"tbody");a.appendChild(g)}g.appendChild(b)}else a.canHaveChildren!==false&&a.appendChild(b);else{if(b.nodeType===11)for(;b.firstChild;)u(a,b.removeChild(b.firstChild))}else if(d==="style"&&n.createStyleSheet)a.cssText=b;else if(a.canHaveChildren!==false)a.appendChild(b);else if(d==="object"&&b.tagName&&b.tagName.toLowerCase()==="param"){try{a.appendChild(b)}catch(c){}try{if(a.object)a.object[b.name]=b.value}catch(e){}}}}function C(a,b,d){if(typeof d==="string")d=new Function("event",d);if(m(d))a[b]=
d}function D(a){return!!a&&a.nodeType===3&&(!a.nodeValue||!/\S/.exec(a.nodeValue))}function E(a,b){if(a&&a.nodeType===3&&b.exec(a.nodeValue))a.nodeValue=a.nodeValue.replace(b,"")}function x(a){if(a){for(;D(a.firstChild);)a.removeChild(a.firstChild);for(E(a.firstChild,M);D(a.lastChild);)a.removeChild(a.lastChild);E(a.lastChild,N)}}function F(a,b){var d=a[b];if(d){try{delete a[b]}catch(g){a[b]=undefined}if(!m(d))try{d=new Function(""+d)}catch(c){d=null}}return d}function G(a){if(a){var b=F(a,"$init");
b&&b.call(a);if(b=F(a,"$load"))setTimeout(function(){b.call(a);b=a=null},0);else b=a=null}}function H(a,b){for(var d=1,g=b.length;d<g;d++){var c=b[d];switch(k(c)){case 2:var e=c[0];c=H(r(e),c);if(e==="html"){x(c);G(c);return c}u(a,c);break;case 4:c!==""&&u(a,n.createTextNode(""+c));break;case 3:if(a.nodeType===1){e=a;var f=c;if(f.name&&n.attachEvent)try{var h=r("<"+e.tagName+" name='"+f.name+"'>");if(e.tagName===h.tagName)e=h}catch(j){}c=void 0;for(c in f)if(f.hasOwnProperty(c)){var i=f[c],y=k(i);
if(c){if(y===0){i="";y=4}c=O[c.toLowerCase()]||c;if(c==="style")if(typeof e.style.cssText!=="undefined")e.style.cssText=i;else e.style=i;else if(c==="class")e.className=i;else if(P[c]){C(e,c,i);s[c]&&C(e,s[c],i)}else if(y===4){e.setAttribute(c,i);s[c]&&e.setAttribute(s[c],i)}else{e[c]=i;if(s[c])e[s[c]]=i}}}a=e}break;case 5:e=u;f=a;i=c;c=r("div");c.innerHTML=""+i;x(c);if(c.childNodes.length===1)c=c.firstChild;else{for(i=r("");c.firstChild;)i.appendChild(c.firstChild);c=i}e(f,c)}}x(a);G(a);if(a.nodeType===
11&&a.childNodes.length===1)a=a.firstChild;return a}var n=v.document;w.prototype.toString=function(){return this.value};var l;l=function(a,b,d,g,c,e){switch(k(a)){case 1:a=a(b,d,g,c);switch(k(a)){case 2:case 3:a=""+a;break;case 0:a=""}return a;case 2:var f=a[0]||"";switch(f){case "$for":a:{var h=a[1]||{};f=[""];var j;if(h.hasOwnProperty("count")){j=h.count;if(m(j))j=j(b,d,g,c);if(h.hasOwnProperty("data")){h=h.data;if(m(h))h=h(b,d,g,c)}else h=b;for(b=0;b<j;b++)p(f,q(a,h,b,j,null,e))}else{if(h.hasOwnProperty("in")){var i=
h["in"];if(m(i))i=i(b,d,g,c);if(k(i)===3){h=[];for(j in i)i.hasOwnProperty(j)&&h.push(j);b=0;for(j=h.length;b<j;b++)p(f,q(a,i[h[b]],b,j,h[b],e));a=f;break a}h=i}else{h=h.each;if(m(h))h=h(b,d,g,c)}b=k(h);if(b===2){b=0;for(j=h.length;b<j;b++)p(f,q(a,h[b],b,j,null,e))}else if(b!==0)f=q(a,h,0,1,null,e)}a=f}return a;case "$xor":return A(a,b,d,g,c,e);case "$if":return A(["$xor",a],b,d,g,c,e);case "$call":e=a[1]||{};if(e.view){f=l(e.view,b,d,g,c);h=e.hasOwnProperty("data")?l(e.data,b,d,g,c):b;j=e.hasOwnProperty("index")?
l(e.index,b,d,g,c):d;i=e.hasOwnProperty("count")?l(e.count,b,d,g,c):g;b=e.hasOwnProperty("key")?l(e.key,b,d,g,c):c;d={};for(g=a.length-1;g>=2;g--){c=a[g];e=c[1]||{};if(e.hasOwnProperty("name"))d[e.name]=c}a=f&&m(f.getView)?l(f.getView(),h,j,i,b,d):null}else a=null;return a;case "$part":f=(a[1]||{}).name||"";f=e&&e.hasOwnProperty(f)?e[f]:a;return q(f,b,d,g,c)}f=[f];h=1;for(j=a.length;h<j;h++)p(f,l(a[h],b,d,g,c,e));return f;case 3:e={};for(f in a)if(a.hasOwnProperty(f))e[f]=l(a[f],b,d,g,c);return e}return a};
var z=v.duel=function(a){return m(a)&&m(a.getView)?a:I(a)};z.raw=z.raw=function(a){return new w(a)};var L={area:true,base:true,basefont:true,br:true,col:true,frame:true,hr:true,img:true,input:true,isindex:true,keygen:true,link:true,meta:true,param:true,source:true,wbr:true};o.FAST=!v.ScriptEngineMajorVersion;o.prototype.append=function(a,b,d){if(o.FAST){this.value+=a;if(b!=null){this.value+=b;if(d!=null)this.value+=d}}else this.value.push.apply(this.value,arguments)};o.prototype.clear=function(){this.value=
o.FAST?"":[]};o.prototype.toString=function(){return o.FAST?this.value:this.value.join("")};t.prototype.toString=function(){var a;var b=this.value;try{var d=new o;B(d,b);a=d.toString()}catch(g){a="["+g+"]"}return a};var O={rowspan:"rowSpan",colspan:"colSpan",cellpadding:"cellPadding",cellspacing:"cellSpacing",tabindex:"tabIndex",accesskey:"accessKey",hidefocus:"hideFocus",usemap:"useMap",maxlength:"maxLength",readonly:"readOnly",contenteditable:"contentEditable"},s={enctype:"encoding",onscroll:"DOMMouseScroll"},
P={onblur:true,onchange:true,onclick:true,ondblclick:true,onerror:true,onfocus:true,onkeydown:true,onkeypress:true,onkeyup:true,onload:true,onmousedown:true,onmouseenter:true,onmouseleave:true,onmousemove:true,onmouseout:true,onmouseover:true,onmouseup:true,onresize:true,onscroll:true,onselect:true,onsubmit:true,onunload:true},M=/^[\r\n]+/,N=/[\r\n]+$/;t.prototype.toDOM=t.prototype.toDOM=function(){try{return H(r(this.value[0]),this.value)}catch(a){return n.createTextNode("["+a+"]")}};return z}(window);