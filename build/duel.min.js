var duel=function(u,F){function v(a){this.value=a}function i(a){switch(typeof a){case "object":return!a?0:a instanceof Array?2:a instanceof v?5:3;case "function":return 1;case "undefined":return 0;default:return 4}}function r(a){if(i(a)!==2)a=["",a];this.value=a}function q(a){if(i(a)!==2)a=["",a];this.value=a}function s(a,b){if(i(a)===2)switch(i(b)){case 2:if(b[0]==="")for(var d=1,c=b.length;d<c;d++)s(a,b[d]);else a.push(b);break;case 3:d=a[1];if(i(d)===3)for(c in b){if(b.hasOwnProperty(c))d[c]=b[c]}else a.splice(1,
0,b);break;case 4:d=a.length-1;if(d>0&&i(a[d])===4)a[d]=""+a[d]+b;else a.push(""+b);break;case 0:break;default:a.push(b)}}function w(a,b,d,c){for(var e=1,f=a.length;e<f;e++){var g=a[e],m=g[1]&&g[1].test;switch(g[0]){case "$if":if(i(m)===1)m=m(b,d,c);if(!m)continue;if(g.length===3)g=g[2];else[""].concat(a.slice(2));return j(g,b,d,c);case "$else":if(g.length===2)g=g[1];else[""].concat(a.slice(1));return j(g,b,d,c)}}return null}function k(){this.value=k.FAST?"":[]}function G(a){if(typeof a!=="string")return a;
return a.replace(/[&<>]/g,function(b){switch(b){case "&":return"&amp;";case "<":return"&lt;";case ">":return"&gt;";default:return b}})}function H(a){if(typeof a!=="string")return a;return a.replace(/[&<>"]/g,function(b){switch(b){case "&":return"&amp;";case "<":return"&lt;";case ">":return"&gt;";case '"':return"&quot;";default:return b}})}function x(a,b){var d=b[0],c=b.length,e=1,f;if(d){a.append("<",d);f=b[e];if(i(f)===3){for(var g in f)if(f.hasOwnProperty(g)){a.append(" ",g);var m=f[g];m&&a.append('="',
H(m),'"')}e++}a.append(">")}for(;e<c;e++){f=b[e];i(f)===2?x(a,f):a.append(G(f))}d&&!I[d]&&a.append("</",d,">")}function y(a){var b=new k;x(b,a);return b.toString()}function n(a){if(!a){if(l.createDocumentFragment)return l.createDocumentFragment();a=""}if(a.toLowerCase()==="style"&&l.createStyleSheet)return l.createStyleSheet();return l.createElement(a)}function t(a,b){if(b)if(a.tagName&&a.tagName.toLowerCase()==="table"&&a.tBodies)if(b.tagName){var d=b.tagName.toLowerCase();if(d&&d!=="tbody"&&d!==
"thead"){var c=a.tBodies.length>0?a.tBodies[a.tBodies.length-1]:null;if(!c){c=n(d==="th"?"thead":"tbody");a.appendChild(c)}c.appendChild(b)}else a.canHaveChildren!==false&&a.appendChild(b)}else{if(b.nodeType===11)for(;b.firstChild;)t(a,b.removeChild(b.firstChild))}else if(a.tagName&&a.tagName.toLowerCase()==="style"&&l.createStyleSheet)a.cssText=b;else if(a.canHaveChildren!==false)a.appendChild(b);else if(a.tagName&&a.tagName.toLowerCase()==="object"&&b.tagName&&b.tagName.toLowerCase()==="param"){try{a.appendChild(b)}catch(e){}try{if(a.object)a.object[b.name]=
b.value}catch(f){}}}function z(a,b,d){if(typeof d==="string")d=new Function("event",d);if(typeof d==="function")a[b]=d}function A(a){return!!a&&a.nodeType===3&&(!a.nodeValue||!/\S/.exec(a.nodeValue))}function B(a){if(a){for(;A(a.firstChild);)a.removeChild(a.firstChild);for(;A(a.lastChild);)a.removeChild(a.lastChild)}}function C(a,b){var d=a[b];if(d){try{delete a[b]}catch(c){a[b]=F}if(typeof d!=="function")try{d=new Function(""+d)}catch(e){d=null}}return d}function J(a){if(a){var b=C(a,"$init");b&&
b.call(a);if(b=C(a,"$load"))setTimeout(function(){b.call(a);b=a=null},0);else b=a=null}}function D(a){return l.createTextNode("["+a+"]")}function E(a,b){for(var d=1;d<b.length;d++){var c=b[d];switch(i(c)){case 2:t(a,E(n(c[0]),c));break;case 4:t(a,l.createTextNode(""+c));break;case 3:if(a.nodeType===1){var e=a,f=c;if(f.name&&l.attachEvent)try{var g=n("<"+e.tagName+" name='"+f.name+"'>");if(e.tagName===g.tagName)e=g}catch(m){}c=void 0;for(c in f)if(f.hasOwnProperty(c)){var h=f[c];if(c&&h){c=K[c.toLowerCase()]||
c;if(c==="style")if(typeof e.style.cssText!=="undefined")e.style.cssText=h;else e.style=h;else if(c==="class")e.className=h;else if(L[c]){z(e,c,h);o[c]&&z(e,o[c],h)}else if(i(h)===4){e.setAttribute(c,h);o[c]&&e.setAttribute(o[c],h)}else{e[c]=h;if(o[c])e[o[c]]=h}}}a=e}break;case 5:e=t;f=a;h=c;c=n("div");c.innerHTML=""+h;B(c);if(c.childNodes.length===1)c=c.firstChild;else{for(h=n("");c.firstChild;)h.appendChild(c.firstChild);c=h}e(f,c)}}B(a);J(a);if(a.nodeType===11&&a.childNodes.length===1)a=a.firstChild;
return a}var l=u.document;v.prototype.toString=function(){return this.value};var j;j=function(a,b,d,c){var e;switch(i(a)){case 1:e=a(b,d,c);break;case 2:var f=a[0]||"";switch(f){case "$for":a=a;f=a[1]&&a[1].each;if(i(f)===1)f=f(b,d,c);a=a.length===3?a[2]:[""].concat(a.slice(2));b=[""];switch(i(f)){case 2:d=0;for(c=f.length;d<c;d++)s(b,j(a,f[d],d,c));break;case 3:for(e in f)f.hasOwnProperty(e)&&s(b,j(a,f[e],e,0))}e=b;break;case "$choose":e=w(a,b,d,c);break;case "$if":case "$else":e=w(["$choose",a],
b,d,c);break;case "$call":var g=a[1];if(!g||!g.view)e=null;else{a=j(g.view,b,d,c);e=j(g.model,b,d,c);f=j(g.index,b,d,c);b=j(g.count,b,d,c);e=j(p(a).value,e,f,b)}break;default:e=[f];f=1;for(g=a.length;f<g;f++)s(e,j(a[f],b,d,c))}break;case 3:e={};for(f in a)if(a.hasOwnProperty(f))e[f]=j(a[f],b,d,c);break;default:e=a}return e};q.prototype.bind=q.prototype.bind=function(a){a=j(this.value,a,0,1);return new r(a)};var I={area:true,base:true,basefont:true,br:true,col:true,frame:true,hr:true,img:true,input:true,
isindex:true,keygen:true,link:true,meta:true,param:true,source:true,wbr:true};k.FAST=u.navigator.userAgent.indexOf("MSIE")<0;k.prototype.append=function(a,b,d){if(k.FAST){this.value+=a;if(b!=null){this.value+=b;if(d!=null)this.value+=d}}else this.value.push.apply(this.value,arguments)};k.prototype.clear=function(){this.value=k.FAST?"":[]};k.prototype.toString=function(){return k.FAST?this.value:this.value.join("")};r.prototype.toString=function(){return y(this.value)};q.prototype.toString=function(){return y(this.value)};
var K={rowspan:"rowSpan",colspan:"colSpan",cellpadding:"cellPadding",cellspacing:"cellSpacing",tabindex:"tabIndex",accesskey:"accessKey",hidefocus:"hideFocus",usemap:"useMap",maxlength:"maxLength",readonly:"readOnly",contenteditable:"contentEditable"},o={enctype:"encoding",onscroll:"DOMMouseScroll"},L={onblur:true,onchange:true,onclick:true,ondblclick:true,onerror:true,onfocus:true,onkeydown:true,onkeypress:true,onkeyup:true,onload:true,onmousedown:true,onmouseenter:true,onmouseleave:true,onmousemove:true,
onmouseout:true,onmouseover:true,onmouseup:true,onresize:true,onscroll:true,onselect:true,onsubmit:true,onunload:true};r.prototype.toDOM=r.prototype.toDOM=function(){try{return E(n(this.value[0]),this.value)}catch(a){try{return(typeof p.onerror==="function"?p.onerror:D)(a,this.value)}catch(b){return D(b)}}};var p=u.duel=function(a){return a instanceof q?a:new q(a)};p.raw=p.raw=function(a){return new v(a)};return p}(window);