var duel=function(){function j(a){switch(typeof a){case "object":return!a?0:a instanceof Array?2:a instanceof n?5:3;case "function":return 1;case "undefined":return 0;default:return 4}}function o(a,b){if(j(a)===2)switch(j(b)){case 2:if(b[0]==="")for(var c=1,e=b.length;c<e;c++)o(a,b[c]);else a.push(b);break;case 3:c=a[1];if(j(c)===3)for(e in b){if(b.hasOwnProperty(e))c[e]=b[e]}else a.splice(1,0,b);break;case 4:c=a.length-1;if(c>0&&j(a[c])===4)a[c]=""+a[c]+b;else a.push(""+b);break;case 0:break;default:a.push(b)}}
function u(a,b,c,e){for(var d=1,f=a.length;d<f;d++){var h=a[d],g=h[1];switch(h[0]){case "$if":var i=g&&g.test;if(j(g.test)===1)i=i(b,c,e);if(!i)continue;if(h.length===3)h=h[2];else[""].concat(a.slice(2));return k(h,b,c,e);case "$else":if(h.length===2)h=h[1];else[""].concat(a.slice(1));return k(h,b,c,e)}}return null}function k(a,b,c,e){var d;switch(j(a)){case 1:d=a(b,c,e);break;case 2:var f=a[0]||"";switch(f){case "$for":a=a;f=a[1];if(!f||!f.each)d=null;else{b=j(f.each)===1?f.each(b,c,e):f.each;a=
a.length===3?a[2]:[""].concat(a.slice(2));c=[""];switch(j(b)){case 2:e=0;for(d=b.length;e<d;e++)o(c,k(a,b[e],e,d));break;case 3:for(d in b)b.hasOwnProperty(d)&&o(c,k(a,b[d],d,0))}d=c}break;case "$choose":d=u(a,b,c,e);break;case "$if":case "$else":d=u(["$choose",a],b,c,e);break;case "$call":var h=a[1];if(h){d=k(h.view,b,c,e);a=k(h.model,b,c,e);f=k(h.index,b,c,e);b=k(h.count,b,c,e);d=k(m(d).value,a,f,b)}else d=null;break;default:d=[f];f=1;for(h=a.length;f<h;f++)o(d,k(a[f],b,c,e))}break;case 3:d={};
for(f in a)if(a.hasOwnProperty(f))d[f]=k(a[f],b,c,e);break;default:d=a}return d}function v(a){if(typeof a!=="string")return a;return a.replace(/[&<>]/g,function(b){switch(b){case "&":return"&amp;";case "<":return"&lt;";case ">":return"&gt;";default:return b}})}function E(a){if(typeof a!=="string")return a;return a.replace(/[&<>"]/g,function(b){switch(b){case "&":return"&amp;";case "<":return"&lt;";case ">":return"&gt;";case '"':return"&quot;";default:return b}})}function w(a,b){var c=b[0],e=b.length,
d=1,f;if(c){a.push("<",c);f=b[d];if(j(f)===3){for(var h in f)if(f.hasOwnProperty(h)){a.push(" ",h);var g=f[h];g&&a.push('="',E(g),'"')}d++}a.push(">")}for(;d<e;d++){f=b[d];j(f)===2?w(a,f):a.push(v(f))}c&&!F[c]&&a.push("</",c,">")}function x(a){if(j(a)!==2)return""+v(a);var b=[];w(b,a);return b.join("")}function p(a,b){if(b)if(a.tagName&&a.tagName.toLowerCase()==="table"&&a.tBodies)if(b.tagName){var c=b.tagName.toLowerCase();if(c&&c!=="tbody"&&c!=="thead"){var e=a.tBodies.length>0?a.tBodies[a.tBodies.length-
1]:null;if(!e){e=document.createElement(c==="th"?"thead":"tbody");a.appendChild(e)}e.appendChild(b)}else a.canHaveChildren!==false&&a.appendChild(b)}else{if(b.nodeType===11)for(;b.firstChild;)p(a,b.removeChild(b.firstChild))}else if(a.tagName&&a.tagName.toLowerCase()==="style"&&document.createStyleSheet)a.cssText=b;else if(a.canHaveChildren!==false)a.appendChild(b);else if(a.tagName&&a.tagName.toLowerCase()==="object"&&b.tagName&&b.tagName.toLowerCase()==="param"){try{a.appendChild(b)}catch(d){}try{if(a.object)a.object[b.name]=
b.value}catch(f){}}}function y(a,b,c){if(typeof c==="string")c=new Function("event",c);if(typeof c==="function")a[b]=c}function z(a){return!!a&&a.nodeType===3&&(!a.nodeValue||!/\S/.exec(a.nodeValue))}function r(a){if(a){for(;z(a.firstChild);)a.removeChild(a.firstChild);for(;z(a.lastChild);)a.removeChild(a.lastChild)}}function A(a){var b=document.createElement("div");b.innerHTML=""+a;r(b);if(b.childNodes.length===1)return b.firstChild;for(a=document.createDocumentFragment?document.createDocumentFragment():
document.createElement("");b.firstChild;)a.appendChild(b.firstChild);return a}function B(a,b){var c=a[b];if(c){try{delete a[b]}catch(e){a[b]=undefined}if(typeof c!=="function")try{c=new Function(""+c)}catch(d){c=null}}return c}function G(a){if(a){var b=B(a,"$init");b&&b.call(a);if(b=B(a,"$load"))setTimeout(function(){b.call(a);b=a=null},0);else b=a=null}}function C(a){return document.createTextNode("["+a+"]")}function D(a,b){for(var c=1;c<b.length;c++){var e=b[c];switch(j(e)){case 2:case 4:p(a,s(e));
break;case 3:if(a.nodeType===1){var d=a;e=e;if(e.name&&document.attachEvent)try{var f=document.createElement("<"+d.tagName+" name='"+e.name+"'>");if(d.tagName===f.tagName)d=f}catch(h){}var g=void 0;for(g in e)if(e.hasOwnProperty(g)){var i=e[g];if(g&&i){g=H[g.toLowerCase()]||g;if(g==="style")if(typeof d.style.cssText!=="undefined")d.style.cssText=i;else d.style=i;else if(g==="class")d.className=i;else if(I[g]){y(d,g,i);l[g]&&y(d,l[g],i)}else if(j(i)===4){d.setAttribute(g,i);l[g]&&d.setAttribute(l[g],
i)}else{d[g]=i;if(l[g])d[l[g]]=i}}}a=d}break;case 5:p(a,A(e))}}return a}function s(a){try{if(!a)return null;if(typeof a==="string")return document.createTextNode(a);if(a instanceof n)return A(a);var b=a[0];if(!b){var c=document.createDocumentFragment?document.createDocumentFragment():document.createElement("");for(b=1;b<a.length;b++)p(c,s(a[b]));r(c);if(c.childNodes.length===1)return c.firstChild;return c}if(b.toLowerCase()==="style"&&document.createStyleSheet){D(document.createStyleSheet(),a);return null}var e=
D(document.createElement(b),a);r(e);G(e);return e}catch(d){try{return(typeof m.onerror==="function"?m.onerror:C)(d,a)}catch(f){return C(f)}}}function n(a){this.value=a}function t(a){this.value=a}function q(a){this.value=a}var F=function(a){for(var b={};a.length;)b[a.pop()]=true;return b}("area,base,basefont,br,col,frame,hr,img,input,isindex,keygen,link,meta,param,source,wbr".split(",")),H={rowspan:"rowSpan",colspan:"colSpan",cellpadding:"cellPadding",cellspacing:"cellSpacing",tabindex:"tabIndex",
accesskey:"accessKey",hidefocus:"hideFocus",usemap:"useMap",maxlength:"maxLength",readonly:"readOnly",contenteditable:"contentEditable"},l={enctype:"encoding",onscroll:"DOMMouseScroll"},I=function(a){for(var b={};a.length;){var c=a.pop();b["on"+c.toLowerCase()]=c}return b}("blur,change,click,dblclick,error,focus,keydown,keypress,keyup,load,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,resize,scroll,select,submit,unload".split(","));n.prototype.toString=function(){return this.value};
t.prototype.toDOM=function(){return s(this.value)};t.prototype.toString=function(){return x(this.value)};q.prototype.bind=function(a){a=k(this.value,a,0,1);return new t(a)};q.prototype.toString=function(){return x(this.value)};var m=function(a){return a instanceof q?a:new q(a)};m.raw=function(a){return new n(a)};return m}();